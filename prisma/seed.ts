import { PrismaClient, Offre, User } from "@prisma/client";

const prisma = new PrismaClient();

async function main() {
  console.log("üå± D√©but du seeding...");

  await prisma.notification.deleteMany({});
  await prisma.rendezVous.deleteMany({});
  await prisma.message.deleteMany({});
  await prisma.favoris.deleteMany({});
  await prisma.offre.deleteMany({});
  await prisma.account.deleteMany({});
  await prisma.session.deleteMany({});
  await prisma.user.deleteMany({});
  await prisma.verificationToken.deleteMany({});

  const usersData = [
    {
      email: "marie.dupont@example.com",
      name: "Marie Dupont",
      image: "https://picsum.photos/150/150?random=1",
    },
    {
      email: "pierre.martin@example.com",
      name: "Pierre Martin",
      image: "https://picsum.photos/150/150?random=2",
    },
    {
      email: "sophie.bernard@example.com",
      name: "Sophie Bernard",
      image: "https://picsum.photos/150/150?random=3",
    },
    {
      email: "lucas.dubois@example.com",
      name: "Lucas Dubois",
      image: "https://picsum.photos/150/150?random=4",
    },
    {
      email: "chloe.petit@example.com",
      name: "Chlo√© Petit",
      image: "https://picsum.photos/150/150?random=5",
    },
    {
      email: "thomas.legrand@example.com",
      name: "Thomas Legrand",
      image: "https://picsum.photos/150/150?random=6",
    },
    {
      email: "emma.riviere@example.com",
      name: "Emma Rivi√®re",
      image: "https://picsum.photos/150/150?random=7",
    },
    {
      email: "alex.durand@example.com",
      name: "Alex Durand",
      image: "https://picsum.photos/150/150?random=8",
    },
    {
      email: "lea.moreau@example.com",
      name: "L√©a Moreau",
      image: "https://picsum.photos/150/150?random=9",
    },
    {
      email: "nicolas.girard@example.com",
      name: "Nicolas Girard",
      image: "https://picsum.photos/150/150?random=10",
    },
  ];

  const createdUsers: User[] = [];
  for (const userData of usersData) {
    const user = await prisma.user.create({ data: userData });
    createdUsers.push(user);
  }
  console.log(`‚úÖ Cr√©√© ${createdUsers.length} utilisateurs`);

  const [user1, user2, user3, user4, user5, user6, user7, user8, user9, user10] = createdUsers;

  const offresData = [
    {
      title: "Aide pour d√©m√©nagement √† Paris",
      description: "Je propose mon aide pour porter des cartons et meubles. Disponible le weekend. J'ai un v√©hicule utilitaire. Je suis fort et fiable !",
      type: "proposition",
      category: "transport",
      location: "Paris 15√®me",
      userId: user1.id,
    },
    {
      title: "Cours de cuisine italienne authentique",
      description: "Passionn√©e de cuisine italienne, je propose des cours priv√©s pour apprendre √† faire des p√¢tes fra√Æches, des sauces et des desserts traditionnels. Tous niveaux bienvenus !",
      type: "proposition",
      category: "cuisine",
      location: "Lyon 3√®me",
      userId: user2.id,
    },
    {
      title: "Services de r√©paration informatique √† domicile",
      description: "Informaticien exp√©riment√©, je propose mes services pour r√©parer vos ordinateurs, installer des logiciels, r√©soudre les probl√®mes de r√©seau et d'optimisation. Diagnostic gratuit !",
      type: "proposition",
      category: "informatique",
      location: "Marseille 8√®me",
      userId: user1.id,
    },
    {
      title: "Garde d'enfants occasionnelle et fiable",
      description: "Maman exp√©riment√©e, je propose de garder vos enfants occasionnellement, en soir√©e ou le weekend. R√©f√©rences v√©rifiables. Activit√©s ludiques assur√©es !",
      type: "proposition",
      category: "garde",
      location: "Nantes",
      userId: user2.id,
    },
    {
      title: "Bricolage et petites r√©parations diverses",
      description: "Bricoleur polyvalent, je peux vous aider pour vos petites r√©parations : plomberie (fuites), √©lectricit√© (prises), peinture, montage de meubles. Travail soign√© et rapide.",
      type: "proposition",
      category: "bricolage",
      location: "Bordeaux",
      userId: user4.id,
    },
    {
      title: "Accompagnement courses pour seniors",
      description: "Je propose de faire les courses pour les personnes √¢g√©es ou √† mobilit√© r√©duite dans mon quartier. Aide au transport et rangement. Gentillesse et patience garanties.",
      type: "proposition",
      category: "courses",
      location: "Nice",
      userId: user5.id,
    },
    {
      title: "Cours de guitare pour d√©butants et interm√©diaires",
      description: "Je propose des cours de guitare acoustique et √©lectrique pour tous √¢ges et niveaux. Styles vari√©s : pop, rock, blues, folk. Apprenez vos morceaux pr√©f√©r√©s !",
      type: "proposition",
      category: "musique",
      location: "Rennes",
      userId: user6.id,
    },
    {
      title: "Promenade de chiens et garde √† la journ√©e",
      description: "Amoureux des animaux, je propose de promener vos chiens pendant votre absence et de les garder √† mon domicile si besoin. Parc √† proximit√©, beaucoup d'amour √† donner !",
      type: "proposition",
      category: "animaux",
      location: "Toulon",
      userId: user7.id,
    },
    {
      title: "Cr√©ation de site web vitrine pour TPE/PME",
      description: "D√©veloppeur web freelance, je peux cr√©er un site web vitrine simple, moderne et responsive pour votre activit√© ou association. Tarifs abordables et devis rapide.",
      type: "proposition",
      category: "informatique",
      location: "Montpellier",
      userId: user8.id,
    },
    {
      title: "Soutien scolaire en math et physique (coll√®ge/lyc√©e)",
      description: "√âtudiante en sciences, je propose des cours de soutien scolaire personnalis√©s en math√©matiques et physique pour les coll√©giens et lyc√©ens. Aide aux devoirs et pr√©paration aux examens.",
      type: "proposition",
      category: "soutien scolaire",
      location: "Lille",
      userId: user9.id,
    },
    {
      title: "Nettoyage de vitres et entretien de v√©randas",
      description: "Service de nettoyage professionnel pour vitres, baies vitr√©es, v√©randas. J'utilise des produits √©cologiques et garantis une propret√© impeccable. Devis gratuit !",
      type: "proposition",
      category: "menage",
      location: "Nice",
      userId: user10.id,
    },

    {
      title: "Recherche aide jardinage pour grand jardin",
      description: "Je cherche quelqu'un pour m'aider √† entretenir mon grand jardin : taille des haies, tonte, plantation, d√©sherbage. Mat√©riel fourni. Urgent !",
      type: "demande",
      category: "jardinage",
      location: "Toulouse",
      userId: user3.id,
    },
    {
      title: "Besoin d'aide pour m√©nage de printemps",
      description: "Je recherche une personne de confiance pour m'aider avec le grand m√©nage de printemps de ma maison. Environ 4-5 heures de travail. Flexible sur les horaires.",
      type: "demande",
      category: "menage",
      location: "Strasbourg",
      userId: user4.id,
    },
    {
      title: "Demande de cours de dessin pour d√©butant",
      description: "Je souhaiterais prendre des cours de dessin (base) pour apprendre les techniques de croquis et d'illustration. Flexible sur les jours et horaires.",
      type: "demande",
      category: "art",
      location: "Paris 12√®me",
      userId: user5.id,
    },
    {
      title: "Cherche aide pour petits travaux de plomberie",
      description: "J'ai une petite fuite sous l'√©vier et j'aurais besoin d'un coup de main pour la r√©parer. Je suis √† la recherche d'un bricoleur.",
      type: "demande",
      category: "bricolage",
      location: "Lyon 7√®me",
      userId: user6.id,
    },
    {
      title: "Recherche professeur de yoga √† domicile",
      description: "Je recherche un professeur de yoga pour des cours particuliers √† domicile (d√©butant). Pr√©f√©rence pour le yoga Vinyasa. Deux fois par semaine.",
      type: "demande",
      category: "sport",
      location: "Nice",
      userId: user7.id,
    },
    {
      title: "Besoin d'un coup de main pour r√©diger un CV",
      description: "Je suis √† la recherche d'une personne pour m'aider √† r√©diger un CV percutant et une lettre de motivation. Je suis jeune dipl√¥m√©.",
      type: "demande",
      category: "services",
      location: "Bordeaux",
      userId: user8.id,
    },
    {
      title: "Recherche aide pour emballage cartons d√©m√©nagement",
      description: "J'ai besoin d'aide pour emballer mes affaires dans des cartons avant un d√©m√©nagement. Je fournis le mat√©riel. Travail minutieux.",
      type: "demande",
      category: "transport",
      location: "Rennes",
      userId: user9.id,
    },
    {
      title: "Cherche d√©veloppeur pour petit projet web",
      description: "Je recherche un d√©veloppeur pour m'aider √† concr√©tiser une id√©e de petit site web personnel. C'est un projet √©ducatif simple.",
      type: "demande",
      category: "informatique",
      location: "Montpellier",
      userId: user10.id,
    },
  ];

  const createdOffres: Offre[] = [];
  for (const offreData of offresData) {
    const offre = await prisma.offre.create({ data: offreData });
    createdOffres.push(offre);
  }
  console.log(`‚úÖ Cr√©√© ${createdOffres.length} offres`);

  const messagesData = [
    {
      fromUserId: user1.id,
      toUserId: user2.id,
      content: "Bonjour Pierre, je suis tr√®s int√©ress√©e par vos cours de cuisine italienne. Seriez-vous disponible en soir√©e la semaine prochaine ?",
      offreId: createdOffres[1].id,
    },
    {
      fromUserId: user2.id,
      toUserId: user1.id,
      content: "Bonjour Marie, oui bien s√ªr ! Mardi ou jeudi soir me conviennent. Quelle heure serait id√©ale pour vous ?",
      offreId: createdOffres[1].id,
    },
    {
      fromUserId: user1.id,
      toUserId: user2.id,
      content: "Je pr√©f√©rerais mardi si possible. Commen√ßons par les bases : p√¢tes fra√Æches ! Impatiente d'apprendre.",
      offreId: createdOffres[1].id,
    },

    {
      fromUserId: user3.id,
      toUserId: user1.id,
      content: "Bonjour Marie, j'ai vu votre annonce pour l'aide au d√©m√©nagement. J'ai un petit appartement √† vider ce samedi. √áa vous int√©resse ?",
      offreId: createdOffres[0].id,
    },
    {
      fromUserId: user1.id,
      toUserId: user3.id,
      content: "Bonjour Sophie, oui, je suis disponible samedi matin. Quel est l'√©tage et le volume estim√© ?",
      offreId: createdOffres[0].id,
    },

    {
      fromUserId: user4.id,
      toUserId: user3.id,
      content: "Bonjour Sophie, j'ai vu votre demande d'aide pour le jardin. Je suis paysagiste et disponible ce weekend. Pouvons-nous en discuter ?",
      offreId: createdOffres[11].id,
    },
    {
      fromUserId: user3.id,
      toUserId: user4.id,
      content: "Bonjour Lucas, oui avec plaisir ! Mon jardin est assez grand, il y a de la taille de haie, de la tonte... Quand seriez-vous libre pour un devis ?",
      offreId: createdOffres[11].id,
    },

    {
      fromUserId: user5.id,
      toUserId: user8.id,
      content: "Bonjour Alex, votre proposition de cr√©ation de site web m'int√©resse. Je voudrais un petit site pour ma galerie d'art en ligne.",
      offreId: createdOffres[8].id,
    },
    {
      fromUserId: user8.id,
      toUserId: user5.id,
      content: "Bonjour Chlo√©, tr√®s bien. Je peux vous faire une proposition rapidement. Avez-vous d√©j√† des exemples de sites que vous aimez ?",
      offreId: createdOffres[8].id,
    },
    {
      fromUserId: user5.id,
      toUserId: user8.id,
      content: "Oui, j'ai quelques r√©f√©rences. On peut en discuter de vive voix ?",
      read: true,
      offreId: createdOffres[8].id,
    },

    {
      fromUserId: user10.id,
      toUserId: user4.id,
      content: "Bonjour Lucas, j'ai vu votre annonce pour l'aide au m√©nage de printemps. Je suis disponible d√®s la semaine prochaine. Quel jour vous conviendrait ?",
      offreId: createdOffres[12].id,
    },
  ];

  for (const messageData of messagesData) {
    await prisma.message.create({ data: messageData });
  }
  console.log(`‚úÖ Cr√©√© ${messagesData.length} messages`);

  const rendezvousData = [
    {
      userId: user1.id,
      offreId: createdOffres[1].id,
      date: new Date(new Date().setDate(new Date().getDate() + 7)),
      statut: "confirme",
      demandeurAccepte: true,
      offreurAccepte: true,
      message: "Rendez-vous confirm√© pour le cours de cuisine mardi soir.",
    },
    {
      userId: user3.id,
      offreId: createdOffres[11].id,
      date: new Date(new Date().setDate(new Date().getDate() + 3)),
      statut: "en_attente",
      demandeurAccepte: true,
      offreurAccepte: false,
      message: "Je vous propose cette date pour l'aide au jardinage.",
    },
    {
      userId: user4.id,
      offreId: createdOffres[12].id,
      date: new Date(new Date().setDate(new Date().getDate() + 5)),
      statut: "refuse",
      demandeurAccepte: true,
      offreurAccepte: false,
      lastModifiedBy: user4.id,
      message: "D√©sol√©, cette date ne me convient pas.",
    },
    {
      userId: user7.id,
      offreId: createdOffres[7].id,
      date: new Date(new Date().setDate(new Date().getDate() + 10)),
      statut: "en_attente",
      demandeurAccepte: false,
      offreurAccepte: false,
      message: "Propose des cr√©neaux pour les promenades de vos chiens.",
    },
  ];

  for (const rvData of rendezvousData) {
    await prisma.rendezVous.create({ data: rvData });
  }
  console.log(`‚úÖ Cr√©√© ${rendezvousData.length} rendez-vous`);

  const favorisData = [
    {
      userId: user1.id,
      offreId: createdOffres[11].id,
    },
    {
      userId: user2.id,
      offreId: createdOffres[0].id,
    },
    {
      userId: user3.id,
      offreId: createdOffres[1].id,
    },
    {
      userId: user6.id,
      offreId: createdOffres[8].id,
    },
    {
      userId: user9.id,
      offreId: createdOffres[7].id,
    },
  ];

  for (const favoriData of favorisData) {
    await prisma.favoris.create({ data: favoriData });
  }
  console.log(`‚úÖ Cr√©√© ${favorisData.length} favoris`);

  const notificationsData = [
    {
      userId: user1.id,
      type: "message_recu",
      title: "Nouveau message",
      message: "Vous avez un nouveau message de Pierre concernant vos cours de cuisine.",
      read: false,
      data: JSON.stringify({ offreId: createdOffres[1].id, fromUserId: user2.id }),
    },
    {
      userId: user3.id,
      type: "rendezvous_demande",
      title: "Nouvelle demande de rendez-vous",
      message: "Lucas a demand√© un rendez-vous pour votre offre de jardinage.",
      read: false,
      data: JSON.stringify({ offreId: createdOffres[11].id, userId: user4.id }),
    },
    {
      userId: user4.id,
      type: "rendezvous_refuse",
      title: "Rendez-vous refus√©",
      message: "Votre demande de rendez-vous pour l'aide m√©nage a √©t√© refus√©e par Chlo√©.",
      read: true,
      data: JSON.stringify({ offreId: createdOffres[12].id, userId: user10.id }),
    },
    {
      userId: user8.id,
      type: "offre_aim√©e",
      title: "Offre ajout√©e aux favoris",
      message: "L√©a a ajout√© votre offre de cr√©ation de site web √† ses favoris !",
      read: false,
      data: JSON.stringify({ offreId: createdOffres[8].id, userId: user5.id }),
    },
  ];

  for (const notificationData of notificationsData) {
    await prisma.notification.create({ data: notificationData });
  }
  console.log(`‚úÖ Cr√©√© ${notificationsData.length} notifications`);

  console.log("‚úÖ Seeding termin√© !");
  console.log(`Cr√©√© ${createdOffres.length} offres pour ${createdUsers.length} utilisateurs`);
}

main()
  .catch((e) => {
    console.error("‚ùå Erreur lors du seeding:", e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
